<div class="crud-form"
	data-unique-hash="a2ad475d60b22954085c657a73309b8f" ng-init="initLoad();loadingStart();">
	<div class="">
		<div class="row">
        	<div class="col-md-12">

                <div class="titleCon">
                    <h3>{{job.title}}</h3>
                </div>

				<div class="form-container table-container">
					<form ng-show="!success" name="form" role="form" novalidate
						class="form-horizontal">

                      <div class="ViewContentPageCon">

                          <div class="row">

                              <div class="col-md-4">

                                  <div class="panel panel-default">
                                      <div class="panel-heading">Job Details - ID - {{job.id}}</div>
                                      <div class="panel-body" style="min-height: 350px;">


                                          <div class="table-responsive">
                                              <table class="table">
                                                  <tbody>
                                                  <tr>
                                                      <td>Title</td>
                                                      <td>{{job.title | uppercase}}</td>
                                                  </tr>
                                                  <tr>
                                                      <td>Description</td>
                                                      <td>{{job.description}}</td>

                                                  </tr>
                                                  <!--<tr>-->
                                                  <!--<td>Checklist</td>-->
                                                  <!--<td>-->
                                                  <!--<ul class="listOfActions list-group">-->
                                                  <!--<li class="list-group-item justify-content-between" ng-repeat="checklist in job.checklistItems">-->
                                                  <!--<span ng-if="!checklist.completed" style="color:red">{{checklist.checklistItemName}}</span>-->
                                                  <!--<span ng-if="checklist.completed" style="color:green">{{checklist.checklistItemName}}</span>-->
                                                  <!--</li>-->
                                                  <!--</ul>-->
                                                  <!--</td>-->

                                                  <!--</tr>-->
                                                  <tr>

                                                      <td>Site </td>
                                                      <td>
                                                          {{job.siteName | uppercase}}
                                                      </td>

                                                  </tr>
                                                  <tr>

                                                      <td>Location</td>
                                                      <td><span ng-if="job.block">{{job.block}},</span>
                                                          <span ng-if="job.floor">{{job.floor}},</span>
                                                          <span ng-if="job.zone">{{job.zone}}</span>
                                                          <span ng-if="!job.block">-</span>
                                                          <span ng-if="!job.floor">-</span>
                                                          <span ng-if="!job.zone">-</span>
                                                      </td>

                                                  </tr>
                                                  <tr>

                                                      <td>Employee</td>
                                                      <td>{{job.employeeName}}</td>

                                                  </tr>
                                                  <tr>

                                                      <td>Asset</td>
                                                      <td><span ng-if="job.assetTitle">{{job.assetTitle}}</span>
                                                          <span ng-if="!job.assetTitle">No assets</span></td>

                                                  </tr>

                                                  </tbody>
                                              </table>
                                          </div>



                                      </div>
                                  </div>


                              </div>
                              <div class="col-md-4">

                                  <div class="panel panel-default">
                                      <div class="panel-heading">Plan</div>
                                      <div class="panel-body" style="min-height: 350px;">


                                          <div class="table-responsive">
                                              <table class="table">
                                                  <tbody>
                                                  <tr>
                                                      <td>Start date</td>
                                                      <td>{{job.plannedStartTime | date :'dd-MMM-yyyy @ hh:mm a'}}</td>
                                                  </tr>
                                                  <tr>
                                                      <td>End date</td>
                                                      <td>{{job.plannedEndTime | date :'dd-MMM-yyyy @ hh:mm a'}}</td>

                                                  </tr>
                                                  <tr>
                                                      <td>Hours</td>
                                                      <td>
                                                          {{job.plannedHours}}
                                                      </td>

                                                  </tr>
                                                  <tr>

                                                      <td>Status </td>
                                                      <td>
                                                          {{job.jobStatus}}
                                                      </td>

                                                  </tr>

                                                  <tr ng-if="job.pendingAtUDS && job.status !='COMPLETED'">

                                                      <td>Job Pending Status </td>
                                                      <td>
                                                          Job Pending at UDS
                                                      </td>

                                                  </tr>

                                                  <tr ng-if="job.pendingAtClient && job.status !='COMPLETED'">

                                                      <td>Job Pending Status </td>
                                                      <td>
                                                          Job Pending at {{job.siteProjectName}}
                                                      </td>

                                                  </tr>
                                                  <tr>

                                                      <td>Type </td>
                                                      <td>
                                                          {{job.jobType}}
                                                      </td>

                                                  </tr>
                                                  <tr>

                                                      <td>Comments </td>
                                                      <td><span ng-if="job.comments">{{job.comments}}</span>
                                                          <span ng-if="!job.comments">No comments</span>
                                                      </td>

                                                  </tr>



                                                  </tbody>
                                              </table>
                                          </div>

                                      </div>
                                  </div>


                              </div>
                              <div class="col-md-4">

                                  <div class="panel panel-default">
                                      <div class="panel-heading">Actual </div>
                                      <div class="panel-body" style="min-height: 350px;">

                                          <div class="table-responsive">
                                              <table class="table">
                                                  <tbody>
                                                  <tr>
                                                      <td>Start date</td>
                                                      <td>{{job.plannedStartTime | date :'dd-MMM-yyyy @ hh:mm a'}}</td>
                                                  </tr>
                                                  <tr>
                                                      <td>End date</td>
                                                      <td>{{job.actualEndTime  | date :'dd-MMM-yyyy @ hh:mm a'}}</td>

                                                  </tr>
                                                  <tr>
                                                      <td>Hours</td>
                                                      <td>
                                                          {{job.actualHours}}
                                                      </td>

                                                  </tr>
                                                  <tr>
                                                      <td>Minutes</td>
                                                      <td>
                                                          {{job.actualMinutes}}
                                                      </td>

                                                  </tr>

                                                  </tbody>
                                              </table>
                                          </div>

                                      </div>
                                  </div>


                              </div>

                          </div>
                          <div class="row">

                              <div class="col-md-4">

                                  <div class="panel panel-default">
                                      <div class="panel-heading">Ticket Details</div>
                                      <div class="panel-body">


                                          <div class="table-responsive">
                                              <table class="table">
                                                  <tbody>
                                                  <tr>
                                                      <td>Ticket Id</td>
                                                      <td>
                                                          <span ng-if="!job.ticketId">-</span>
                                                          <a ng-if="(job.ticketId > 0)" ng-class="{active: $state.includes('admin')}" ui-sref="view-ticket({id : job.ticketId})"  ng-click=""  onClick="" data-target="#myModal"  class="btn btn-simple btn-info">View Ticket {{job.ticketId}}</a>
                                                          <a ng-if="(job.ticketId > 0) && job.jobStatus == 'COMPLETED' && ticketStatus != 'Closed'" ng-class="{active: $state.includes('admin')}"  ng-click="closeTicket(job.ticketId)"   onClick="$('#closeTicket').modal()"     class="btn btn-simple btn-info">Close Ticket {{job.ticketId}}</a>
                                                          <a ng-if="(job.ticketId > 0) && job.jobStatus == 'COMPLETED' && ticketStatus == 'Closed'" ng-class="{active: $state.includes('admin')}" class="btn btn-simple btn-info">Ticket# {{job.ticketId}} Closed </a>
                                                      </td>
                                                  </tr>
                                                  </tbody>
                                              </table>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>

                      </div>

                        <div class="row">
                            <div class="col-md-12" ng-show="job.images.length>0">
                                <div class="panel panel-default">
                                    <div class="panel-heading">Completed Images </div>
                                    <div class="panel-body">
                                        <div class="col-md-2" ng-repeat="image in job.images">
                                            <!--{{image}}-->
                                            <!--<a id="{{ 'jobPhoto-' + $index }}" href="#" onClick="$('#myModal').modal()" data-target="#myModal" data-dismiss="#myModal" ng-click="loadImages(job.employeeEmpId,image.photoOut, $index)">-->
                                            <!--<img data-ng-src="/api/employee/{{job.employeeEmpId}}/checkInOut/{{image.photoOut}}" width="30px" height="30px"/>-->
                                            <!--</a>-->
                                            <a onClick="$('#myModal').modal()" data-target="#myModal" data-dismiss="#myModal" ng-click="loadCompletedJob(image.url)" >
                                                <img ng-src="{{image.url}}" width="150px" height="150px">

                                            </a>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="panel panel-default">
                                <div class="panel-heading">Check List</div>
                                <div class="panel-body">
                                    <table class="table">
                                        <tbody>
                                        <tr>
                                            <th>Checklist Item </th>
                                            <th>Remarks</th>
                                            <th>Status</th>
                                            <th>Images</th>
                                        </tr>
                                        <tr ng-repeat="checklist in job.checklistItems">
                                            <td><span ng-if="!checklist.completed" style="color:red">{{checklist.checklistItemName}}</span>
                                                <span ng-if="checklist.completed" style="color:green">{{checklist.checklistItemName}}</span>
                                            </td>
                                            <td>
                                                <span ng-if="checklist.remarks">{{checklist.remarks}}</span>
                                                <span ng-if="!checklist.remarks">No remarks</span>
                                            </td>
                                            <td>
                                                <span class="label label-success" ng-if="checklist.completed">Completed</span>
                                                <span class="label label-warning" ng-if="!checklist.completed">Not Completed</span>
                                            </td>
                                            <td>
                                                <span ng-if="!checklist.imageUrl_1">No image</span>
                                                <a ng-if="checklist.imageUrl_1" onClick="$('#myModal').modal()" data-target="#myModal" data-dismiss="#myModal" ng-click="loadCompletedJob(checklist.imageUrl_1)" >
                                                    <img ng-src="{{checklist.imageUrl_1}}" width="80px" height="80px">
                                                </a>
                                                <a ng-if="checklist.imageUrl_2" onClick="$('#myModal').modal()" data-target="#myModal" data-dismiss="#myModal" ng-click="loadCompletedJob(checklist.imageUrl_2)" >
                                                    <img ng-src="{{checklist.imageUrl_2}}" width="80px" height="80px">
                                                </a>
                                                <a ng-if="checklist.imageUrl_3" onClick="$('#myModal').modal()" data-target="#myModal" data-dismiss="#myModal" ng-click="loadCompletedJob(checklist.imageUrl_3)" >
                                                    <img ng-src="{{checklist.imageUrl_3}}" width="80px" height="80px">
                                                </a>
                                            </td>
                                        </tr>
                                        </tbody>
                    			</table>
                    		<div></div>
                    	<div></div>

                	</div>

            	</div>

        	</div>
        	
        	              <div class="row">
                            <div class="panel panel-default">
                                <div class="panel-heading">Materials</div>
                                <div class="panel-body">
                                    <table class="table">
                                        <tbody>
                                        <tr>
                                            <th>Item Name</th>
                                            <th>Item Code</th>
                                            <th>Item Group</th>
                                            <th>Store Stock</th>
                                            <th>Quantity</th>
                                            <th>UOM</th>
                                        </tr>
                                        <tr ng-repeat="material in job.jobMaterials">
                                       		<td>{{material.materialName}}</td>
                                       		<td>{{material.materialCode}}</td>
                                       		<td>{{material.materialGroup}}</td>
                                       		<td>{{material.materialStock}}</td>
                                       		<td>{{material.materialQuantity}}</td>
                                       		<td>{{material.materialUom}}</td>
                                        </tr>
                                         <tr>
                                            <td colspan="5" align="center" ng-show="!job.jobMaterials.length">No Materials Used</td>
                                         </tr>
                                        </tbody>
                    			</table>
                    		<div></div>
                    	<div></div>

                	</div>

            	</div>

        	</div>



        <!--<div class="titleCon">-->
                            <!--<h5>Actual Start and End</h5>-->
                        <!--</div>-->






						<!-- Start of hidden inputs -->
						<!-- End of hidden inputs -->

						<div class='small-loading hidden' id='FormLoading'>Loading,
							saving data...</div>

						<div class="form-group">
							<div id='report-error' class='report-div error bg-danger'
								style="display: none"></div>
							<div id='report-success' class='report-div success bg-success'
								style="display: none"></div>
						</div>
						<div class="form-group">
							<div class="col-sm-12 txt-align-rgt">

								<button class="btn btn-default " type="button"
									ng-click="back('cancel')" id="cancel-button">
									<i class=""></i> Back
								</button>
							</div>
						</div>
					</form>
					<script type="text/javascript">
					$('.form-control').attr('readonly',true)
					</script>
				</div>
			</div>
		</div>
	</div>

</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-notice" style="width: 400px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="material-icons">clear</i></button>
                <h5 class="modal-title" id="myModalLabel">Job Photo</h5>
            </div>
            <div class="modal-body">

                <div class="txt-align-center">
                    <img id="photoStart" style="width:300px;height:300px" />
                </div>


            </div>
            <div class="modal-footer text-center">
                <button type="button" class="btn btn-danger btn-round" data-dismiss="modal">close</button>
            </div>
        </div>
    </div>
</div>

<!-- Ticket Close confirmation dialog -->
<div id="deleteModalNew" class="delete-confirmation modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-hidden="true">&times;</button>
                <h4 class="modal-title">Close Ticket</h4>
            </div>
            <div class="modal-body">
                <p>Are you sure that you want to close ticket?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button"
                        class="btn btn-success delete-confirmation-button" ng-click="closeTicketConfirm(cTicket)">Close Ticket</button>
            </div>
        </div>
    </div>
</div>
<!-- End of Ticket Close confirmation dialog -->

<!-- Ticket Close confirmation dialog -->
<div id="closeTicket" class="delete-confirmation modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-hidden="true">&times;</button>
                <h4 class="modal-title">Close Ticket</h4>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to close the ticket?</p>
                <br/>
                <input class="form-control border-bottom-input" ng-model="cTicket.comments" placeholder="Enter Remarks..">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button"
                        class="btn btn-success delete-confirmation-button" ng-click="closeTicketConfirm(cTicket)">Close Ticket</button>
            </div>
        </div>
    </div>
</div>
<!-- End of Ticket Close confirmation dialog -->
