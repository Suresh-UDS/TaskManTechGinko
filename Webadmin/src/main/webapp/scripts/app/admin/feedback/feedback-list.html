<div ng-init="initLoad()">

    <!-- New changes Start -->

    <div class="row">


        <div class="col-md-6 txt-align-lft">
            <button class="btn btn-success add-btn margn-tb0" data-toggle="modal" data-target="#AdvancedFilterModal" tabindex="0">
                <i class="material-icons">filter_list</i>Filter
                <div class="ripple-container"></div>
            </button>
            <button class="btn btn-warning  add-btn margn-tb0"  ng-click="refreshPage()" tabindex="0">
                <i class="material-icons">refresh</i>Clear filter
                <div class="ripple-container"></div>
            </button>
        </div>

        <div class="col-md-6 txt-align-rgt">

        </div>

    </div>
    <div class="AppliedFilterCon" ng-show="!searchCriteria.findAll || localStorage">
            <span class="AppliedFilterTxtCon">
                <span class="tag label label-info"  style="margin-right: 10px" ng-show="searchCriteria.checkInDateTimeFrom || localStorage.checkInDateTimeFrom">
                    From: {{searchCriteria.checkInDateTimeFrom || localStorage.checkInDateTimeFrom | date:'dd/MM/yyyy'}}
                </span>
                <span class="tag label label-info"  style="margin-right: 10px" ng-show="searchCriteria.checkInDateTimeTo || localStorage.checkInDateTimeTo">
                    To: {{searchCriteria.checkInDateTimeTo || localStorage.checkInDateTimeTo | date:'dd/MM/yyyy'}}
                </span>
                <span class="tag label label-info" style="margin-right: 10px" ng-show="searchCriteria.projectName || localStorage.projectName">
                    Client: {{searchCriteria.projectName || localStorage.projectName}}
                </span>

                <span class="tag label label-info"  style="margin-right: 10px" ng-show="searchCriteria.siteName || localStorage.siteName">
                    Site: {{searchCriteria.siteName || localStorage.siteName}}
                </span>
                <span class="tag label label-info" style="margin-right: 10px"  ng-show="searchCriteria.block || localStorage.block">
                    Block: {{searchCriteria.block || localStorage.block}}
                </span>

                <span class="tag label label-info" style="margin-right: 10px" ng-show="searchCriteria.floor || localStorage.floor">
                    Floor: {{searchCriteria.floor || localStorage.floor}}
                </span>

                <span class="tag label label-info"  style="margin-right: 10px"ng-show="searchCriteria.zone || localStorage.zone">
                    Zone: {{searchCriteria.zone || localStorage.zone}}
                </span>

            </span>
            <button ng-show="feedbackCount > 0" class="btn btn-info add-btn margn-tb0 ld ld-over-inverse" ng-class="{'running':(downloader && typeMsg=='xlsx')}"   title="Export Excel"  ng-click=exportAllData('xlsx') tabindex="0">
                <i class="material-icons">import_contacts</i> Export Excel
                <i class="ld ld-ring ld-spin" ng-show="downloader"></i>
                <div class="ripple-container"></div>
            </button>
            <span ng-if="exportMsg()=='Download'">
                 <a class="download-btn" href="{{exportFile()}}" download target="_self" ng-click="clsDownload()" ng-hide="downloaded">{{exportMsg()}}</a>
                 <div class="downloader" ng-show="downloader"></div>
            </span>
            <span ng-if="exportMsg()!='Download'">
                 <a class="download-btn" href="javascript:void(0);">{{exportMsg()}}</a>
            </span>

    </div>
    <!-- New changes End -->

   <form name="searchForm"  novalidate >

    <div class="PrintDiv" id="printable">
        <div class="row FeedbackDashboardCon">
            <div class="col-md-12">


                <!--<div class="card"  >-->

                    <!--<div class="card-content">-->

                        <!--<div class="SearchTable">-->

                                <!--<table class=" no-padding-tblCon" border="0">-->
                                    <!--<tr class="filter-row gc-search-row">-->
                                        <!--<td width="15%">-->
                                            <!--<div class="form-group pdng-top20" >-->
                                                <!--<span class="form-control-feedback calender-icon"><i class="material-icons">date_range</i></span>-->
                                                <!--<input ng-model="selectedFromDate" id="dateFilterFrom" type="text" class="form-control datepicker border-bottom-input"   />-->
                                            <!--</div>-->
                                        <!--</td>-->

                                        <!--<td width="15%">-->
                                            <!--<div class="form-group pdng-top20"  >-->
                                                <!--<span class="form-control-feedback calender-icon"><i class="material-icons">date_range</i></span>-->
                                                <!--<input ng-model="selectedToDate" id="dateFilterTo" type="text" class="form-control datepicker border-bottom-input"   />-->
                                            <!--</div>-->
                                        <!--</td>-->
                                        <!--<td width="25%">-->
                                            <!--<div class="form-group pad10px">-->
                                                <!--<label class="control-label">Client</label>-->
                                                <!--<span class="form-control-feedback d-big-arrow-icon"><i class="material-icons">keyboard_arrow_down</i></span>-->
                                                <!--<select class="form-control " ng-model="selectedProject"  ng-change="loadSites()"  ng-options="project as project.name for project in projects">-->
                                                    <!--<option value="">Select Client...</option>-->
                                                <!--</select>-->

                                            <!--</div>-->
                                        <!--</td>-->

                                        <!--<td width="20%">-->
                                            <!--<div class="form-group pad10px">-->
                                                <!--<label class="control-label">Site</label>-->
                                                <!--<span class="form-control-feedback d-big-arrow-icon"><i class="material-icons">keyboard_arrow_down</i></span>-->
                                                <!--<select class="form-control " ng-model="selectedSite"  ng-change="searchLocations();loadFeedbackMasters();" ng-options="site as site.name for site in sites">-->
                                                    <!--<option value="">Select Site...</option>-->
                                                <!--</select>-->
                                            <!--</div>-->
                                        <!--</td>-->
                                        <!--<td align="right" width="15%">-->
                                            <!--<div class="floatR form-group">-->
                                                <!--<button type="submit" class="btn btn-circle blue-clr" ng-disabled="searchForm.$invalid" ng-click="search()">-->
                                                    <!--<i class="material-icons">search</i>-->
                                                <!--</button>-->
                                                <!--<button ng-show="attendancesData.length" type="button"  ng-click=exportAllData() class="btn btn-circle green-clr">-->
                                                    <!--<i class="material-icons">file_upload</i>-->
                                                <!--</button>-->
                                                <!--<button ng-click="refreshPage()" class="btn btn-circle orange-clr">-->
                                                    <!--<i class="material-icons">refresh</i>-->
                                                <!--</button>-->
                                                <!--&lt;!&ndash;<button ng-click="printDiv('printable')" class="btn btn-circle orange-clr">&ndash;&gt;-->
                                                    <!--&lt;!&ndash;<i class="material-icons">print</i>&ndash;&gt;-->
                                                <!--&lt;!&ndash;</button>&ndash;&gt;-->
                                                <!--<a class="download-btn" href="{{exportFile(0)}}">{{exportMsg(0)}}</a>-->

                                            <!--</div>-->
                                        <!--</td>-->
                                    <!--</tr>-->
                                    <!--<tr class="filter-row gc-search-row">-->


                                        <!--&lt;!&ndash; td>-->
                                            <!--<div class="form-group">-->
                                                 <!--<label class="control-label">Block<span class="red-star">*</span> </label>-->
                                                 <!--<select class="form-control " ng-model="selectedBlock" ng-change="loadFloors()"  ng-options="block as block for  block in  blocks">-->
                                                     <!--<option value="">Please select Block...</option>-->
                                                 <!--</select>-->
                                             <!--</div>-->
                                        <!--</td>-->
                                         <!--<td>-->
                                            <!--<div class="form-group">-->
                                                 <!--<label class="control-label">Floor<span class="red-star">*</span> </label>-->
                                                 <!--<select class="form-control " ng-model="selectedFloor" ng-change="loadZones()"  ng-options="floor as floor for floor in floors">-->
                                                      <!--<option value="">Please select Floor...</option>-->
                                                  <!--</select>-->
                                             <!--</div>-->
                                        <!--</td>-->
                                        <!--<td>-->
                                            <!--<div class="form-group">-->
                                                 <!--<label class="control-label">Zone<span class="red-star">*</span> </label>-->
                                                  <!--<select class="form-control " ng-model="selectedZone"  ng-options="zone as zone for zone in zones">-->
                                                     <!--<option value="">Please select Zone...</option>-->
                                                 <!--</select>-->
                                             <!--</div>-->
                                        <!--</td&ndash;&gt;-->

                                    <!--</tr>-->
                                <!--</table>-->

                                <!--<div class="TailsCon">-->
                                    <!--<div class="TailsContent">-->
                                        <!--<ul class="blocksListCon">-->
                                           <!--<li ng-repeat="item in filteredLocations" ng-class="item.zone == selectedZone && item.block== selectedBlock && item.floor== selectedFloor ? 'active' : ''"> <a type="submit" ng-click="genZoneReport(item.projectId,item.siteId,item.block, item.floor,item.zone,searchForm)"  ng-show="(($index < (vm.page * vm.numRecords)) && ($index >= ((vm.page - 1) * vm.numRecords)))">{{ item.block }}<br/>{{item.floor}}<br/>{{item.zone}}</a></li>-->
                                        <!--</ul>-->

                                        <!--<div class="clear"></div>-->
                                        <!--&lt;!&ndash;<div class="pos-abs next"><button ng-click="vm.next()"><i class="material-icons">keyboard_arrow_right</i></button></div>&ndash;&gt;-->
                                        <!--&lt;!&ndash;<div class="pos-abs back"><button ng-click="vm.back()"><i class="material-icons">keyboard_arrow_left</i></button></div>&ndash;&gt;-->
                                    <!--</div>-->
                                <!--</div>-->

                        <!--</div>-->


                    <!--</div>-->
                <!--</div>-->


                <div class="card">

                    <div class="card-content">

                        <div class="row">

                            <div class="col-md-6">

                                <div class="row">

                                    <div class="col-md-6">
                                        <h3>No of Feedbacks</h3>
                                    </div>
                                    <div class="col-md-6">
                                        <h3>{{feedbackCount}}</h3>
                                    </div>

                                </div>

                            </div>
                            <div class="col-md-6">

                                <div class="row">

                                    <div class="col-md-6">
                                        <h3>Overall rating ({{averageRating}})</h3>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- USE COMPONENT HERE-->

                                        <!-- <div class="RatingCon"> -->
                                        <div class="average">

                                            <!-- <jk-rating-stars max-rating="5" rating="feedbackReport.overallRating" read-only="readOnly" >
                                            </jk-rating-stars> -->

                                            <average-star-rating ng-model="averageRating" max="5"></average-star-rating>



                                        </div>




                                    </div>

                                </div>

                            </div>


                        </div>

                    </div>

                </div>

                <div class="card" >

                    <div class="card-content">

                        <div class="row">

                            <div class="col-md-6">

                                <h3>Feedback Comparison</h3>

                                <canvas id="line" class="chart chart-bar" chart-data="data"
                                        chart-labels="labels" chart-series="series" chart-dataset-override="datasetOverride" chart-colors="colors" chart-click="onClick">
                                </canvas>

                            </div>

                            <div style="" class="col-md-6">

                                <h3>Rating pattern</h3>

                                <canvas id="doughnut" class="chart chart-doughnut"
                                        chart-data="datas" chart-labels="label" chart-options="chartOptions" chart-legend = "true">
                                </canvas>

                            </div>

                        </div>

                    </div>

                </div>


                <div class="card margin-TB-5 TableCard">

                    <!--<div class="card-header card-header-icon" data-background-color="purple">-->
                    <!--<i class="material-icons">assignment</i>-->
                    <!--</div>-->
                    <div class="card-content">
                        <!--<h4 class="card-title">DataTables.net</h4>-->


                        <div class="table-responsive tablecard">
                            <table class="table table-striped">
                                <thead>
                                <tr>
								   <th>Location</th>
                                    <th>Question</th>
                                    <th>Yes</th>
                                    <th>No</th>
                                    <th>Rating</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="questionRating in feedbackReport.questionRatings">
                                    <td>{{questionRating.location}}</td>
                                    <td>{{questionRating.question}}</td>
                                    <td>{{questionRating.yesCount}}</td>
                                    <td>{{questionRating.noCount}}</td>
                                    <td>
                                        <div ng-repeat ="(key, value) in questionRating.rating">
                                            ({{value}}) <jk-rating-stars max-rating="5" rating="key" read-only="readOnly" ></jk-rating-stars>
                                        </div>
                                    </td>
                                </tr>
                                </thead>
                                <tbody>

                                </tbody>
                            </table>



                        </div>

                    </div>
                    <!-- end content-->
                </div>
                <!--  end card  -->
            </div>
            <!-- end col-md-12 -->
        </div>
        <!-- end row -->
    </div>
  </form>


    <div class="card margin-TB-5 txt-align-center" ng-hide="feedbackListData">

        <div class="card-content">

            <div class="" style="text-align:center;padding: 10px 0;" ng-hide="feedbackListLoader">
                <div loader-css="ball-pulse"></div>
            </div>

            <h3>No feedbacks</h3>

        </div>

    </div>


    <!-- Pagination directive start -->

   <!--  <pagination-new></pagination-new> -->

    <!-- Pagination directive end -->



</div>


<!-- BasicFilterModal -->


<div class="modal fade AdvancedFilterModal FilterModalCon" id="AdvancedFilterModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form name="searchForm"  ng-submit="searchFilter();"  novalidate >
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <i class="material-icons">clear</i>
                    </button>
                    <h4 class="modal-title">Filter</h4>
                </div>
                <div class="modal-body">

                    <div class="row">

                        <div class="col-xs-12 col-md-3">
                            <div class="form-group pdng-top20" >
                                <span class="form-control-feedback calender-icon"><i class="material-icons">date_range</i></span>
                                <input ng-model="selectedFromDate" id="dateFilterFrom" type="text" class="form-control datepicker border-bottom-input"  autocomplete="off" />
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-3">
                            <div class="form-group pdng-top20"  >
                                <span class="form-control-feedback calender-icon"><i class="material-icons">date_range</i></span>
                                <input ng-model="selectedToDate" id="dateFilterTo" type="text" class="form-control datepicker border-bottom-input"  autocomplete="off" />
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-3">
                            <div class="form-group" >
                                <div class="dropdown">
                                    <label class="label-control">Client</label>
                                    <!--<span class="form-control-feedback d-arrow-icon"><i class="material-icons">keyboard_arrow_down</i></span>-->
                                    <!--<select class="form-control " ng-model="searchProject" ng-change="loadDepSites()" ng-options="project as project.name for project in projectsList track by project.id" ng-pattern="Select Client" ng-required>-->
                                    <!--<option value="">Select Client...</option>-->
                                    <!--</select>-->
                                    <span ng-show="clientFilterDisable"  class="form-control-feedback d-big-arrow-icon orange-color"><i class="ld ld-ring ld-spin" ></i></span>
                                    <span ng-show="!clientFilterDisable" class="form-control-feedback d-big-arrow-icon "><i class="material-icons">keyboard_arrow_down</i></span>
                                    <ui-select ng-model="selectedProject" ng-disabled="clientFilterDisable" ng-change="loadSearchProject(selectedProject);loadSites()" ng-click="loadSearchProject(selectedProject);loadSites()">
                                        <ui-select-match placeholder="Select client...">{{filter ? selectedProject.name?selectedProject.name:'Select client' :clearField?'Select Client':selectedProject}}</ui-select-match>
                                        <ui-select-choices  repeat="client in getClient($select.search) | filter: $select.search">
                                            <div ng-bind="client"></div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-3">
                            <div class="dropdown">
                                <div class="form-group">
                                    <label class="label-control">Site</label>
                                    <!--<span class="form-control-feedback d-arrow-icon"><i class="material-icons">keyboard_arrow_down</i></span>-->
                                    <!--<select class="form-control " ng-model="searchSite"  ng-options="site as site.name for site in sitesList track by site.id" ng-pattern="Select Site">-->
                                    <!--<option value="">Select Site...</option>-->
                                    <!--</select>-->
                                    <span ng-show="siteSpin"  class="form-control-feedback d-big-arrow-icon orange-color"><i class="ld ld-ring ld-spin" ></i></span>
                                    <span ng-show="!siteSpin" class="form-control-feedback d-big-arrow-icon "><i class="material-icons">keyboard_arrow_down</i></span>
                                    <!--<span class="form-control-feedback d-big-arrow-icon "><i class="material-icons">keyboard_arrow_down</i></span>-->
                                    <ui-select ng-model="selectedSite" ng-disabled="siteFilterDisable || sites.length == 0" ng-click="loadSearchSite(selectedSite);searchLocations();loadFeedbackMasters();">
                                        <ui-select-match placeholder="Select site...">{{sites.length == 0 ? 'Select site' : selectedSite.searchStatus ? selectedSite.name?selectedSite.name:'Select Site' : hideSite ?clearField?'Select site':selectedSite : 'Select Site' }}</ui-select-match>
                                        <ui-select-choices  repeat="site in getSite($select.search) | filter: $select.search">
                                            <div ng-bind="site"></div>
                                        </ui-select-choices>
                                    </ui-select>
                                    <span ng-if="sites.length == 0"><p class="error-msg margin0">No sites</p></span>
                                </div>
                            </div>
                        </div>


                    </div>

                    <div class="TailsCon">
                        <div class="TailsContent">
                            <ul class="blocksListCon">
                                <li ng-repeat="item in filteredLocations"   ng-click="genZoneReport(item.projectId,item.siteId,item.block, item.floor,item.zone,searchForm)" ng-class="item.zone == selectedZone && item.block== selectedBlock && item.floor== selectedFloor ? 'active' : ''"> <a type="submit"   ng-show="(($index < (vm.page * vm.numRecords)) && ($index >= ((vm.page - 1) * vm.numRecords)))">{{ item.block }}<br/>{{item.floor}}<br/>{{item.zone}}</a></li>
                            </ul>

                            <div class="clear"></div>
                            <!--<div class="pos-abs next"><button ng-click="vm.next()"><i class="material-icons">keyboard_arrow_right</i></button></div>-->
                            <!--<div class="pos-abs back"><button ng-click="vm.back()"><i class="material-icons">keyboard_arrow_left</i></button></div>-->
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger btn-simple" data-dismiss="modal" >Cancel</button>
                    <button type="submit" class="btn btn-success btn-simple" ng-click = "search()" data-dismiss="modal" ng-disabled="searchForm.$invalid">Apply Filter</button>
                    <!--<button type="button" class="btn btn-danger btn-simple" data-dismiss="modal">Close</button>-->
                </div>
            </form>
        </div>
    </div>
</div>

<!--  End Modal -->
