<div class="crud-form"
	data-unique-hash="a2ad475d60b22954085c657a73309b8f" ng-init="loadingStart();">
	<div class="" ng-init="editTicket();">
		<div class="row">
        	<div class="col-md-12">

                <div class="titleCon">
                    <h3>{{tickets.title | uppercase}}</h3>
                </div>

				<div class="form-container table-container">
					<form ng-show="!success" name="form" role="form" novalidate
						class="form-horizontal">


                        <div class="row ViewContentPageCon">

                            <div class="col-md-4">

                                <div class="panel panel-default">
                                    <div class="panel-heading">Ticket Details</div>
                                    <div class="panel-body" style="min-height: 265px;">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <tbody>
                                                <tr>
                                                    <td>Issue</td>
                                                    <td ng-if="tickets.title">{{tickets.title | uppercase}}</td>
                                                </tr>
                                                <tr>
                                                    <td>Description</td>
                                                    <td ng-if="tickets.description">{{tickets.description | capitalize}}</td>

                                                </tr>
                                                <tr>
                                                    <td>Severity</td>
                                                    <td>

                                                     {{tickets.severity}}

                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td>Status</td>
                                                    <td>

                                                     {{tickets.status}}

                                                    </td>

                                                </tr>

                                                <tr ng-if="!tickets.pendingAtClient && tickets.status !='Completed'">

                                                    <td>Pending Status </td>
                                                    <td>
                                                        Ticket Pending at UDS
                                                    </td>

                                                </tr>

                                                <tr ng-if="tickets.pendingAtClient && tickets.status !='Completed'">

                                                    <td>Pending Status </td>
                                                    <td>
                                                        Ticket Pending at {{tickets.siteName}}
                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td>Job</td>
                                                    <td><span ng-if="tickets.jobId">
                                  	                <a ng-if="(tickets.jobId > 0)" ui-sref="view-job({id : tickets.jobId})" ng-click="closeModal()" class="btn btn-simple btn-info">View Job {{tickets.jobId}}</a></span><span ng-if="!tickets.jobId">-</span>
                                                    </td>
                                                </tr>


                                                </tbody>
                                            </table>
                                        </div>



                                    </div>
                                </div>


                            </div>
                            <div class="col-md-4">

                                <div class="panel panel-default">
                                    <div class="panel-heading">Site & Employee</div>
                                    <div class="panel-body" style="min-height: 265px;">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <tbody>
                                                <tr>
                                                    <td>Site</td>
                                                    <td>{{selectedSite.name}}</td>
                                                </tr>
                                                <tr>
                                                    <td>Employee</td>
                                                    <td>
                                                        <span ng-if="selectedEmployee.name">{{selectedEmployee.name}}</span>
                                                        <span ng-if="!selectedEmployee.name">-</span>
                                                    </td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                </div>

                            </div>
                            <div class="col-md-4">

                                <div class="panel panel-default">
                                    <div class="panel-heading">Assets</div>
                                    <div class="panel-body" style="min-height: 265px;">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <tbody>
                                                <tr>
                                                    <td>Name of Asset</td>
                                                    <td><span ng-if="selectedAsset.title">{{selectedAsset.title}}</span>
                                                    <span ng-if="!selectedAsset.title">No Assets</span>
                                                    </td>
                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                </div>

                            </div>
                            <div class="col-md-4">
	                            <div class="panel panel-default">
	                                    <div class="panel-heading">Image</div>
	                                    <div class="panel-body" style="min-height: 265px;">


	                                        <div class="table-responsive">
	                                            <table class="table">
	                                                <tbody>
	                                                <tr>
	                                                    <td>Image</td>
	                                                    <td><span ng-if="ticketImage">
                                                                <a id="images" href="javascript:void(0);" onClick="$('#myModalNew').modal()" data-target="#myModalNew" data-dismiss="#myModalNew" ng-click="loadTicketImage(ticketImage,tickets.id)">
                                                                    <img  src={{ticketImage}} width="100px" height="100px" />
                                                                </a>
                                                        </span>
                                                        <span ng-if="!ticketImage">No Images</span>

	                                                    </td>
	                                                </tr>
	                                                </tbody>
	                                            </table>
	                                        </div>

	                                    </div>
	                                </div>
                            </div>
                            <div class="col-md-4">

                                <div class="panel panel-default">
                                    <div class="panel-heading">Comments & Remarks </div>
                                    <div class="panel-body" style="min-height: 265px;">

                                        <div class="table-responsive">
                                            <table class="table">
                                                <tbody>
                                                <tr>
                                                    <td>Comments</td>
                                                    <td><span ng-if="tickets.comments">{{tickets.comments}}</span><span ng-if="!tickets.comments">No comments</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Remarks</td>
                                                    <td><span ng-if="tickets.remarks">{{tickets.remarks}}</span><span ng-if="!tickets.remarks">No remarks</span></td>
                                                </tr>


                                                </tbody>
                                            </table>
                                        </div>

                                    </div>
                                </div>


                            </div>

                        </div>


						<!-- Start of hidden inputs -->
						<!-- End of hidden inputs -->

						<div class='small-loading hidden' id='FormLoading'>Loading,
							saving data...</div>

						<div class="form-group">
							<div id='report-error' class='report-div error bg-danger'
								style="display: none"></div>
							<div id='report-success' class='report-div success bg-success'
								style="display: none"></div>
						</div>


                        <div class="txt-align-rgt">
                            <button class="btn btn-default " type="button"
                                    ng-click="back('cancel')" id="cancel-button">
                                <i class=""></i> Back
                            </button>
                            <button class="btn btn-info" type="button" ng-if="(tickets.status != 'Closed')"ng-class="{active: $state.includes('admin')}" has-permission="Ticket:Close"   ng-click="closeTicket(tickets.id)"   onClick="$('#closeTicket').modal()" data-target="#myModal"
                                     >
                                <i class=""></i> close ticket
                            </button>
                            <button class="btn btn-sucess" type="button" has-permission="Ticket:Reopen" ng-if="tickets.status == 'Closed'"  ng-click="reopenTicket(tickets.id)"   onClick="$('#reopenModalNew').modal()" data-target="#myModal"
                                     >
                                <i class=""></i> Reopen ticket
                            </button>
                        </div>

					</form>
					<script type="text/javascript">
					$('.form-control').attr('readonly',true)
					</script>
				</div>
			</div>
		</div>
	</div>

</div>

<!-- Ticket Close confirmation dialog -->
<div id="closeTicket" class="delete-confirmation modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-hidden="true">&times;</button>
                <h4 class="modal-title">Close Ticket</h4>
            </div>
            <div class="modal-body">
               <p>Are you sure you want to close the ticket?</p>
               <br/>
               <input class="form-control border-bottom-input" ng-model="cTicket.remarks" placeholder="Enter Remarks..">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button"
                        class="btn btn-success delete-confirmation-button" ng-click="closeTicketConfirm(cTicket)"   >Close Ticket</button>
            </div>
        </div>
    </div>
</div>
<!-- End of Ticket Close confirmation dialog -->

<!-- Ticket Reopen confirmation dialog -->
<div id="reopenModalNew" class="delete-confirmation modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-hidden="true">&times;</button>
                <h4 class="modal-title">Reopen Ticket</h4>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to reopen the ticket?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button"
                        class="btn btn-success delete-confirmation-button" ng-click="reopenTicketConfirm(cTicket)">Reopen Ticket</button>
            </div>
        </div>
    </div>
</div>
<!-- End of Ticket Close confirmation dialog -->

<div id="myModalNew" class="modal fade" data-backdrop="false" tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <table >
                        <thead>
                        <tr >
                            <th style="text-align: center">Ticket Image</th>

                        </tr>
                        </thead>
                        <tr>

                            <td><img id="ticketImage" width="250" height="250" src="#"
                                     class="img-responsive"></td>
                        </tr>

                    </table>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>



